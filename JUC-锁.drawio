<mxfile host="app.diagrams.net" modified="2021-06-30T03:22:43.099Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36" etag="O7kiYQheHaPk1evd_gZ5" version="14.8.2" type="github">
  <diagram name="Page-1" id="5d7acffa-a066-3a61-03fe-96351882024d">
    <mxGraphModel dx="2514" dy="1325" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="8500" pageHeight="20000" background="#ffffff" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="2debaab0fafb2da2-10" value="Object" style="html=1;rounded=0;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=2;fontFamily=Verdana;fontSize=12;align=center;shape=mxgraph.ios7ui.horLines;" parent="1" vertex="1">
          <mxGeometry x="1272.5" y="656" width="135" height="50" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-6" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1260" y="290" width="160" height="110" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-7" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-6" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-8" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-6" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-9" value="Row 3" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-6" vertex="1">
          <mxGeometry y="78" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-10" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1660" y="290" width="160" height="130" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-11" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-10" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-12" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-10" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-52" value="Row 3" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-10" vertex="1">
          <mxGeometry y="78" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-13" value="Row 4" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-10" vertex="1">
          <mxGeometry y="104" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-14" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1260" y="482" width="160" height="110" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-15" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-14" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-16" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-14" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-17" value="Row 3" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-14" vertex="1">
          <mxGeometry y="78" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-18" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1260" y="786" width="160" height="140" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-19" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-18" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-20" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-18" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-51" value="Row 3" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-18" vertex="1">
          <mxGeometry y="78" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-21" value="Row 4" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-18" vertex="1">
          <mxGeometry y="104" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-22" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1660" y="482" width="160" height="84" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-23" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-22" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-24" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-22" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-26" value="Function" style="swimlane;html=1;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#e0e0e0;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;swimlaneFillColor=#ffffff;align=center;rounded=1;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=1;fontFamily=Verdana;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1660" y="786" width="160" height="110" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-27" value="Row 1" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-26" vertex="1">
          <mxGeometry y="26" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-28" value="Row 2" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-26" vertex="1">
          <mxGeometry y="52" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-29" value="Row 3" style="text;html=1;strokeColor=none;fillColor=none;spacingLeft=4;spacingRight=4;whiteSpace=wrap;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="21ea969265ad0168-26" vertex="1">
          <mxGeometry y="78" width="160" height="26" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-30" value="Object" style="html=1;rounded=0;shadow=0;comic=0;labelBackgroundColor=none;strokeWidth=2;fontFamily=Verdana;fontSize=12;align=center;shape=mxgraph.ios7ui.horLines;" parent="1" vertex="1">
          <mxGeometry x="1480" y="656" width="135" height="50" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-31" style="edgeStyle=none;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-18" target="2debaab0fafb2da2-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-32" style="edgeStyle=none;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="2debaab0fafb2da2-10" target="21ea969265ad0168-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-33" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;exitX=1;exitY=0.25;entryX=1;entryY=0.5;" parent="1" source="21ea969265ad0168-18" target="21ea969265ad0168-17" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1450" y="821" />
              <mxPoint x="1450" y="573" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-34" value="" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-30" target="21ea969265ad0168-27" edge="1">
          <mxGeometry x="-0.1342" y="32" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-35" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-14" target="21ea969265ad0168-30" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1548" y="556" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-36" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-6" target="21ea969265ad0168-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-37" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-26" target="21ea969265ad0168-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-38" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-10" target="21ea969265ad0168-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-39" style="edgeStyle=orthogonalEdgeStyle;html=1;entryX=0;entryY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;exitX=1;exitY=0.5;" parent="1" source="21ea969265ad0168-8" target="21ea969265ad0168-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-40" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-11" target="21ea969265ad0168-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-41" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-9" target="21ea969265ad0168-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21ea969265ad0168-42" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-16" target="21ea969265ad0168-24" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-43" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-24" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1980" y="547" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-44" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1980" y="825" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-45" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;entryX=1;entryY=0.5;" parent="1" target="21ea969265ad0168-28" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1990" y="835" as="targetPoint" />
            <mxPoint x="1980" y="851" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1980" y="851" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-46" style="edgeStyle=orthogonalEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;entryX=1;entryY=0.5;" parent="1" target="21ea969265ad0168-29" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1830.1904761904761" y="861.0952380952381" as="targetPoint" />
            <mxPoint x="1980" y="877" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1900" y="877" />
              <mxPoint x="1900" y="877" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-47" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1980" y="329" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-48" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1980" y="355" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-49" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;" parent="1" source="21ea969265ad0168-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1980" y="381" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="21ea969265ad0168-50" style="edgeStyle=elbowEdgeStyle;html=1;labelBackgroundColor=none;startFill=0;startSize=8;endFill=1;endSize=8;fontFamily=Verdana;fontSize=12;elbow=vertical;entryX=1.011;entryY=0.152;entryPerimeter=0;" parent="1" target="21ea969265ad0168-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1840" y="305" as="targetPoint" />
            <mxPoint x="1980" y="310" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1910" y="310" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-1" value="&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;public final void &lt;/span&gt;acquire&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;arg&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;!&lt;/span&gt;tryAcquire&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;arg&lt;span style=&quot;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;amp;&amp;amp;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;acquireQueued&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;addWaiter&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;Node&lt;span style=&quot;&quot;&gt;.&lt;/span&gt;EXCLUSIVE&lt;span style=&quot;&quot;&gt;), &lt;/span&gt;arg&lt;span style=&quot;&quot;&gt;))&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;selfInterrupt&lt;span style=&quot;&quot;&gt;();&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="1970" y="365" width="580" height="125" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-2" value="公平锁" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=#000000;align=left;" vertex="1" parent="1">
          <mxGeometry x="2784" y="262" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-3" value="非公平锁" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=#000000;align=left;" vertex="1" parent="1">
          <mxGeometry x="3609" y="267" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-12" value="&lt;h1&gt;Heading&lt;/h1&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;public final void &lt;/span&gt;acquire(&lt;span style=&quot;font-weight: bold&quot;&gt;int &lt;/span&gt;arg) {&lt;br&gt;    &lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;(!tryAcquire(arg) &amp;amp;&amp;amp;&lt;br&gt;        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))&lt;br&gt;        selfInterrupt();&lt;br&gt;}&lt;/pre&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;labelBackgroundColor=none;fontColor=#000000;align=left;" vertex="1" parent="1">
          <mxGeometry x="2035" y="106" width="607" height="244" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="CqtvCm25UIUQusRmt474-13" target="CqtvCm25UIUQusRmt474-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="CqtvCm25UIUQusRmt474-13" target="CqtvCm25UIUQusRmt474-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-13" value="&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;public final void &lt;/span&gt;acquire(&lt;span style=&quot;font-weight: bold&quot;&gt;int &lt;/span&gt;arg) {//模板方法，tryAcquire()由子类负责实现&lt;br&gt;    &lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;(!tryAcquire(arg) &amp;amp;&amp;amp;&lt;br&gt;        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))&lt;br&gt;        selfInterrupt();&lt;br&gt;}&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=#000000;align=left;" vertex="1" parent="1">
          <mxGeometry x="3070" y="740" width="778" height="133" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="CqtvCm25UIUQusRmt474-14" target="CqtvCm25UIUQusRmt474-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-14" value="&lt;span style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt; font-weight: bold;&quot;&gt;final void &lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt; font-weight: bold; font-style: italic;&quot;&gt;lock&lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;() {&lt;/span&gt;&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;&quot;&gt;acquire&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;align=left;arcSize=9;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="2768" y="403" width="535" height="119.5" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="CqtvCm25UIUQusRmt474-19" target="CqtvCm25UIUQusRmt474-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3707" y="633" />
              <mxPoint x="3459" y="633" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-19" value="&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;final void &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;lock&lt;/span&gt;&lt;span&gt;() {&lt;br&gt;&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;compareAndSetState&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;))//立即抢锁&lt;br&gt;&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span&gt;setExclusiveOwnerThread&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;Thread&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;currentThread&lt;/span&gt;&lt;span&gt;())&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;else&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;        &lt;/span&gt;&lt;span&gt;acquire&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;//抢锁失败，&lt;br&gt;&lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=#ffffff;align=left;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="3394" y="392" width="626" height="212" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-22" value="&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;protected final boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;tryAcquire&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Thread &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Thread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot;&gt;currentThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;&quot;&gt;getState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;== &lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;&quot;&gt;hasQueuedPredecessors&lt;/span&gt;&lt;span style=&quot;&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;amp;&amp;amp;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;&quot;&gt;compareAndSetState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;&quot;&gt;setExclusiveOwnerThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return true&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;else if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current &lt;/span&gt;&lt;span style=&quot;&quot;&gt;== &lt;/span&gt;&lt;span style=&quot;&quot;&gt;getExclusiveOwnerThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;+ &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc &lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;lt; &lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;&quot;&gt;Error&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&quot;Maximum lock count exceeded&quot;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return true&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return false&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=#ffffff;align=left;arcSize=7;" vertex="1" parent="1">
          <mxGeometry x="2443" y="1025" width="727" height="462" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-26" value="&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;protected final boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;tryAcquire&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;&quot;&gt;nonfairTryAcquire&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot;; font-size: 12.8pt;&quot;&gt;&lt;pre style=&quot;font-family: &amp;quot;pt mono&amp;quot; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;final boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;nonfairTryAcquire&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Thread &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;Thread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;&quot;&gt;currentThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;&quot;&gt;getState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;== &lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;compareAndSetState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;&quot;&gt;setExclusiveOwnerThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return true&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    }&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;else if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;current &lt;/span&gt;&lt;span style=&quot;&quot;&gt;== &lt;/span&gt;&lt;span style=&quot;&quot;&gt;getExclusiveOwnerThread&lt;/span&gt;&lt;span style=&quot;&quot;&gt;()) {&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc &lt;/span&gt;&lt;span style=&quot;&quot;&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;c &lt;/span&gt;&lt;span style=&quot;&quot;&gt;+ &lt;/span&gt;&lt;span style=&quot;font-weight: bold; font-style: italic;&quot;&gt;acquires&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;if &lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc &lt;/span&gt;&lt;span style=&quot;&quot;&gt;&amp;lt; &lt;/span&gt;&lt;span style=&quot;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;font-style: italic;&quot;&gt;// overflow&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;throw new &lt;/span&gt;&lt;span style=&quot;&quot;&gt;Error&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;&quot;&gt;&quot;Maximum lock count exceeded&quot;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;&quot;&gt;setState&lt;/span&gt;&lt;span style=&quot;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;nextc&lt;/span&gt;&lt;span style=&quot;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return true&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold;&quot;&gt;return false&lt;/span&gt;&lt;span style=&quot;&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;glass=0;labelBackgroundColor=#ffffff;strokeColor=#000000;align=left;arcSize=3;" vertex="1" parent="1">
          <mxGeometry x="3744" y="1023" width="798" height="498" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-29" value="&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;公平锁与非公平锁tryAcquire()的&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;实现唯一的区别是，公平锁多了了一个&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;!hasQueuedPredecessors()判断&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;表示不是排在第一的位置&lt;/pre&gt;&lt;/pre&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;glass=0;labelBackgroundColor=#ffffff;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3317" y="1074" width="313" height="143" as="geometry" />
        </mxCell>
        <mxCell id="CqtvCm25UIUQusRmt474-30" value="&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;b&gt;这个方法只有抢到锁之后才会返回,&lt;/b&gt;&lt;/pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;&lt;b&gt;该函数不会中断响应，但它会记录被阻塞期间有没有其他线程向它发送过中断信号。如果有，则该函数会返回true；否则，返回false。&lt;/b&gt;&lt;/span&gt;&lt;/font&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;final boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;acquireQueued&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;Node &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;node&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;int &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;arg&lt;/span&gt;&lt;span&gt;) {&lt;br&gt;&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;failed &lt;/span&gt;&lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;true&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;try &lt;/span&gt;&lt;span&gt;{&lt;br&gt;&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;interrupted &lt;/span&gt;&lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;false&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;for &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;;;&lt;/span&gt;&lt;span&gt;) {//在没有阻塞的情况下，不断取获取锁&lt;br&gt;&lt;/span&gt;&lt;span&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;final &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;Node &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;p &lt;/span&gt;&lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;node&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;predecessor&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;p &lt;/span&gt;&lt;span&gt;== &lt;/span&gt;head &lt;span&gt;&amp;amp;&amp;amp; &lt;/span&gt;&lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;arg&lt;/span&gt;&lt;span&gt;)) {&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &lt;/span&gt;&lt;span&gt;setHead&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;node&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;p&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;next &lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;null&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span style=&quot;font-style: italic&quot;&gt;// help GC&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-style: italic&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;failed &lt;/span&gt;&lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;false&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;interrupted&lt;/span&gt;&lt;span&gt;;//获取锁之后，返回&lt;br&gt;&lt;/span&gt;&lt;span&gt;            &lt;/span&gt;&lt;span&gt;}&lt;br&gt;&lt;/span&gt;&lt;span&gt;            &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;shouldParkAfterFailedAcquire&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;p&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;node&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &lt;/span&gt;&lt;span&gt;parkAndCheckInterrupt&lt;/span&gt;&lt;span&gt;())&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;interrupted &lt;/span&gt;&lt;span&gt;= &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;true&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span&gt;}&lt;br&gt;&lt;/span&gt;&lt;span&gt;    } &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;finally &lt;/span&gt;&lt;span&gt;{&lt;br&gt;&lt;/span&gt;&lt;span&gt;        &lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;if &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;failed&lt;/span&gt;&lt;span&gt;)&lt;br&gt;&lt;/span&gt;&lt;span&gt;            &lt;/span&gt;&lt;span&gt;cancelAcquire&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;node&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;    &lt;/span&gt;&lt;span&gt;}&lt;br&gt;&lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span style=&quot;font-weight: bold&quot;&gt;private final boolean &lt;/span&gt;&lt;span style=&quot;font-weight: bold ; font-style: italic&quot;&gt;parkAndCheckInterrupt&lt;/span&gt;&lt;span&gt;() {&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;&lt;span&gt;阻塞当前线程,&lt;/span&gt;直到被其他线程唤醒，该函数才返回；park（）函数返回有两种情况。&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;情况1：其他线程调用了unpark（Thread t）。&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;情况2：其他线程调用了t.interrupt（）。这里要注意的是，lock（）不能响应中断，但LockSupport.park（）会响应中断。&lt;/pre&gt;&lt;pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;也正因为LockSupport.park（）可能被中断唤醒，acquireQueued（..）函数才写了一个for死循环；&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;唤醒之后，如果发现自己排在队列头部，就去拿锁；如果拿不到锁，则再次自己阻塞自己；&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;不断重复此过程，直到拿到锁。被唤醒之后，通过Thread.interrupted（）来判断是否被中断唤醒；&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;如果是情况1，会返回false；&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;font face=&quot;pt mono&quot;&gt;&lt;span style=&quot;font-size: 17.0667px&quot;&gt;如果是情况2，则返回true；&lt;/span&gt;&lt;span style=&quot;font-size: 12.8pt&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;&lt;pre&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt ; font-weight: bold&quot;&gt;LockSupport&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;park&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt ; font-weight: bold&quot;&gt;this&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt ; font-weight: bold&quot;&gt;return &lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt ; font-weight: bold&quot;&gt;Thread&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;interrupted&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;pt mono&amp;#34; ; font-size: 12.8pt&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;glass=0;labelBackgroundColor=none;strokeColor=#000000;fillColor=#ffffff;align=left;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="3092" y="1579" width="1104" height="1043" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
